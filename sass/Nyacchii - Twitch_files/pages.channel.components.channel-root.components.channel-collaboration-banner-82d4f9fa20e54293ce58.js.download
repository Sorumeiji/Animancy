(window.webpackJsonp=window.webpackJsonp||[]).push([[129],{"/guG":function(e,n,a){"use strict";a.d(n,"c",(function(){return u})),a.d(n,"b",(function(){return s})),a.d(n,"d",(function(){return o})),a.d(n,"a",(function(){return d}));var t=a("mrSG"),r=a("/7QA"),i=a("2xye");function u(e){return Object(t.__awaiter)(this,void 0,void 0,(function(){var n,a;return Object(t.__generator)(this,(function(t){return n=null,e.channelID&&(n=parseInt(e.channelID,10),isNaN(n)&&(n=null)),a={squad_stream_id:e.squadStreamID||null,squad_stream_session_id:e.squadStreamSessionID||null,squad_stream_presentation_id:e.squadStreamPresentationID||null,layout:e.layout||null,channel_id:n,player_order:e.playerOrder||null,total_players:e.totalPlayers||null,chat_shown:e.chatShown},[2,r.p.tracking.track(i.SpadeEventType.SquadStreamPresentation,a)]}))}))}function s(e){return Object(t.__awaiter)(this,void 0,void 0,(function(){var n,a,u;return Object(t.__generator)(this,(function(t){return n=null,e.userID&&(n=parseInt(e.userID,10),isNaN(n)&&(n=null)),a=null,e.channelID&&(a=parseInt(e.channelID,10),isNaN(a)&&(a=null)),u={action:e.action||null,user_id:n,channel:e.channel||null,channel_id:a,time:e.time||null,squad_stream_id:e.squadStreamID||null},[2,r.p.tracking.track(i.SpadeEventType.SquadStreamBannerAction,u)]}))}))}function o(e){return Object(t.__awaiter)(this,void 0,void 0,(function(){var n,a,u;return Object(t.__generator)(this,(function(t){return n=null,e.userID&&(n=parseInt(e.userID,10),isNaN(n)&&(n=null)),a=null,e.channelID&&(a=parseInt(e.channelID,10),isNaN(a)&&(a=null)),u={element:e.element||null,type:e.type||null,location:e.location||null,user_id:n,channel_id:a,player_order:e.playerOrder||null,total_players:e.totalPlayers||null,squad_stream_id:e.squadStreamID||null,squad_stream_session_id:e.squadStreamSessionID||null,is_active:e.isActive},[2,r.p.tracking.track(i.SpadeEventType.SquadStreamViewerAction,u)]}))}))}function d(e){return Object(t.__awaiter)(this,void 0,void 0,(function(){var n;return Object(t.__generator)(this,(function(a){return n={user_id:e.userID,device_id:e.deviceID,primary_player_channel_login:e.primaryPlayerChannelLogin,ad_played_player_channel_login:e.adPlayedPlayerChannelLogin,is_server_side_ad:e.isServerSideAd,squad_stream_id:e.squadStreamID,squad_stream_session_id:e.squadStreamSessionID},[2,r.p.tracking.track(i.SpadeEventType.SquadStreamAdPlay,n)]}))}))}},aKsW:function(e,n,a){"use strict";var t,r,i,u;a.d(n,"a",(function(){return t})),a.d(n,"b",(function(){return r})),a.d(n,"d",(function(){return i})),a.d(n,"c",(function(){return u})),function(e){e.View="view",e.Click="click"}(t||(t={})),function(e){e.ExitSquadMode="exit_squad_mode",e.ChannelLink="channel_link",e.Player="player",e.Avatar="avatar",e.ProvideFeedback="provide_feedback"}(r||(r={})),function(e){e.Hover="hover",e.Click="click"}(i||(i={})),function(e){e.TopBar="top_bar",e.Player="player",e.ProfileCard="profile_card",e.EndedState="ended_state"}(u||(u={}))},dByk:function(e,n,a){"use strict";a.d(n,"a",(function(){return i}));var t=a("0Log"),r=a("DMoW");function i(e){if(!e||!e.squad||!e.squad.owner_id)return null;for(var n=[],a=0,t=e.squad.members;a<t.length;a++){var r=t[a],i={__typename:"User",id:r.id,login:r.login,displayName:r.display_name,profileImageURL:r.profile_image_url_150};n.push(i)}return{__typename:"SquadStream",id:e.squad.id,status:u(e.squad.status),members:n,owner:{__typename:"User",id:e.squad.owner_id}}}function u(e){switch(e){case t.SquadStatus.Pending:return r.Oc.PENDING;case t.SquadStatus.Live:return r.Oc.LIVE;case t.SquadStatus.Ended:default:return r.Oc.ENDED}}},"nKq/":function(e,n,a){"use strict";a.r(n);var t=a("mrSG"),r=a("w09P"),i=a("q1tI"),u=a("fvjX"),s=a("yR8l"),o=a("eDVu"),d=a("0Log"),l=a("/aPz"),c=a("DMoW"),m=a("Ty5D"),p=a("/7QA"),h=a("GnwI"),f=a("aKsW"),S=a("/guG"),q=a("+80q"),v=a("X2PJ"),b=a("HSpZ"),y=a("Ws8v"),_=a("hnjF"),g=a("sUnt"),k=a("dEDE"),I=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.goToSquadPage=function(){n.trackBannerAction(f.a.Click),n.props.history.push("/"+n.props.channelLogin+"/squad")},n.trackBannerAction=function(e){Object(S.b)({action:e,userID:n.props.currentUserID,channel:n.props.channelLogin,channelID:n.props.channelID,time:new Date,squadStreamID:n.props.squadStreamID})},n.makeBannerText=function(e,n){var a=function(e){return e&&e.displayName?i.createElement(q.a,{bold:!0,noWrap:!0,type:q.e.Span,color:v.c.Overlay},e.displayName):""};switch(n.length){case 0:return Object(p.d)("{channelOwnerName} is Squad Streaming",{channelOwnerName:a(e)},"SquadStreamBanner");case 1:return Object(p.d)("{channelOwnerName} is Squad Streaming with {squadMemberIndex0}",{channelOwnerName:a(e),squadMemberIndex0:a(n[0])},"SquadStreamBanner");case 2:return Object(p.d)("{channelOwnerName} is Squad Streaming with {squadMemberIndex0}, {squadMemberIndex1}",{channelOwnerName:a(e),squadMemberIndex0:a(n[0]),squadMemberIndex1:a(n[1])},"SquadStreamBanner");default:return Object(p.d)("{channelOwnerName} is Squad Streaming with {squadMemberIndex0}, {squadMemberIndex1}, {squadMemberIndex2}",{channelOwnerName:a(e),squadMemberIndex0:a(n[0]),squadMemberIndex1:a(n[1]),squadMemberIndex2:a(n[2])},"SquadStreamBanner")}},n.trackSquadBannerAction=function(e){Object(S.b)({action:e,userID:n.props.currentUserID,channel:n.props.channelLogin,channelID:n.props.channelID,time:new Date,squadStreamID:n.props.squadStreamID})},n}return Object(t.__extends)(n,e),n.prototype.componentDidMount=function(){this.trackSquadBannerAction(f.a.View)},n.prototype.render=function(){var e=this.props.channelID,n=this.props.squadMembers.filter((function(n){return n.id===e}))[0],a=this.props.squadMembers.filter((function(n){return n.id!==e}));return i.createElement(b.a,{type:b.f.SlideInBottom,delay:b.b.Medium,duration:b.c.Medium,enabled:!0},i.createElement(y.a,{display:_.d.Flex,background:v.a.Accent,alignItems:_.b.Center,padding:1,borderRadius:v.b.None,elevation:2},i.createElement(g.a,{ellipsis:!0},i.createElement(q.a,{noWrap:!0,type:q.e.Span,color:v.c.Overlay,fontSize:v.d.Size5},this.makeBannerText(n,a))),i.createElement(g.a,{display:_.d.Flex,alignItems:_.b.Start,flexGrow:1}),i.createElement(g.a,{margin:{right:1}},i.createElement(k.a,{onClick:this.goToSquadPage,type:k.d.Primary,overlay:!0,"data-a-target":"squad-stream-banner-button"},Object(p.d)("Watch In Squad Mode","SquadStreamBanner")))))},n}(i.Component),D=Object(u.d)(Object(h.withLatencyTracking)("SquadStreamBanner",{autoReportInteractive:!0}),m.j)(I),w=a("dByk"),O=a("yMkG"),N=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return Object(t.__extends)(n,e),n.prototype.componentDidMount=function(){this.props.triggerPlayerReposition()},n.prototype.componentDidUpdate=function(){this.props.triggerPlayerReposition()},n.prototype.render=function(){return this.shouldRenderSquadBanner(this.props)?i.createElement(D,{channelID:this.props.channelID,channelLogin:this.props.channelLogin,channelDisplayName:this.props.channelDisplayName,currentUserID:this.props.data.currentUser&&this.props.data.currentUser.id||"",squadMembers:this.props.data&&this.props.data.user&&this.props.data.user.squadStream&&this.props.data.user.squadStream.members||[],squadStreamID:this.props.data.user&&this.props.data.user.squadStream&&this.props.data.user.squadStream.id||""}):null},n.prototype.isSquadMember=function(e){var n=e.channelID,a=e.data&&e.data.user&&e.data.user.squadStream&&e.data.user.squadStream.members||[];return!(!a||a.length<2||!a.some((function(e){return e.id===n})))},n.prototype.shouldRenderSquadBanner=function(e){return!!this.isSquadMember(e)&&(!e.data.loading&&!e.data.error&&(e.data.user&&e.data.user.squadStream&&e.data.user.squadStream.status===c.Oc.LIVE||!1))},n}(i.Component),E=Object(u.d)(Object(s.a)(O,{options:function(e){return{variables:{channelLogin:e.channelLogin}}}}),Object(o.a)((function(e){return{query:O,variables:{channelLogin:e.channelLogin},topic:Object(l.l)(e.channelID),type:d.PubsubMessageType.Squad,mutator:function(e,n){var a=Object(w.a)(e);return n.user?r(n,(function(e){return e.user.squadStream}),(function(){return a})):n}}})))(N);a.d(n,"ChannelCollaborationBannerComponent",(function(){return N})),a.d(n,"ChannelCollaborationBanner",(function(){return E}))},yMkG:function(e,n,a){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CollaborationBanner"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"channelLogin"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"login"},value:{kind:"Variable",name:{kind:"Name",value:"channelLogin"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"squadStream"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"squadStreamData"},directives:[]}]}}]}},{kind:"Field",name:{kind:"Name",value:"currentUser"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:215}};t.loc.source={body:'#import "twilight/features/squad-stream/models/squad-stream-fragment.gql"\nquery CollaborationBanner($channelLogin: String!) {\nuser(login: $channelLogin) {\nid\nsquadStream {\n...squadStreamData\n}\n}\ncurrentUser {\nid\n}\n}',name:"GraphQL request",locationOffset:{line:1,column:1}};var r={};t.definitions=t.definitions.concat(a("fnDh").definitions.filter((function(e){if("FragmentDefinition"!==e.kind)return!0;var n=e.name.value;return!r[n]&&(r[n]=!0,!0)})));var i={};function u(e,n){for(var a=0;a<e.definitions.length;a++){var t=e.definitions[a];if(t.name&&t.name.value==n)return t}}t.definitions.forEach((function(e){if(e.name){var n=new Set;!function e(n,a){if("FragmentSpread"===n.kind)a.add(n.name.value);else if("VariableDefinition"===n.kind){var t=n.type;"NamedType"===t.kind&&a.add(t.name.value)}n.selectionSet&&n.selectionSet.selections.forEach((function(n){e(n,a)})),n.variableDefinitions&&n.variableDefinitions.forEach((function(n){e(n,a)})),n.definitions&&n.definitions.forEach((function(n){e(n,a)}))}(e,n),i[e.name.value]=n}})),e.exports=t,e.exports.CollaborationBanner=function(e,n){var a={kind:e.kind,definitions:[u(e,n)]};e.hasOwnProperty("loc")&&(a.loc=e.loc);var t=i[n]||new Set,r=new Set,s=new Set;for(t.forEach((function(e){s.add(e)}));s.size>0;){var o=s;s=new Set,o.forEach((function(e){r.has(e)||(r.add(e),(i[e]||new Set).forEach((function(e){s.add(e)})))}))}return r.forEach((function(n){var t=u(e,n);t&&a.definitions.push(t)})),a}(t,"CollaborationBanner")}}]);